{% include 'head.html' %}
<body>
    <div class="container">
        <div class="jumbotron mt-3">
            <h1>{{ title }}</h1>  
            <div style="margin: 0 0 10px 0">
            {% if title == 'crypto-base-encode' %}   
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="base" id="b16" value="16" checked>
                    <label class="form-check-label" for="b16">base16</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="base" id="b32" value="32">
                    <label class="form-check-label" for="b32">base32</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="base" id="b64" value="64">
                    <label class="form-check-label" for="b64">base64</label>
                </div>
            {% elif title in ['hash-encrypt', 'hash-decrypt'] %}
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="func" id="m5" value="md5" checked>
                    <label class="form-check-label" for="m5">md5</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="func" id="s1" value="sha1">
                    <label class="form-check-label" for="s1">sha1</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="func" id="s256" value="sha256">
                    <label class="form-check-label" for="s256">sha256</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="func" id="s384" value="sha384">
                    <label class="form-check-label" for="s384">sha384</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="func" id="s512" value="sha512">
                    <label class="form-check-label" for="s512">sha512</label>
                </div>
            {% elif title == 'web-post' %}
                <input type="text" class="form-control" id="url" placeholder="URL">
                <input type="text" class="form-control" id="form-data" placeholder="form" disabled>
                <input type="text" class="form-control" id="json-data" placeholder="json">
            {% endif %}
            {% if title != 'forensic-file-info' %}
                <input type="text" class="form-control" name="input" id="input" placeholder="{{'Input' if title != 'forensic-find-string' else 'Regular Expresion'}}">      
            {% endif %}
            {% if title in ['forensic-file-info', 'forensic-find-string'] %}
                <div style="margin: 10px 0 0 0;">
                    <form name="fileform" enctype="multipart/form-data">
                        <div class="input-group mb-3">
                            <div class="custom-file">
                                <input type="file" name="file" id="file" class="custom-file-input">
                                <label class="custom-file-label" for="file">Choose file</label>
                            </div>
                        </div>
                    </form>
                </div>
            {% endif %}
            </div>
            <div class="input-group" style="margin: 0 0 10px 0;">
                <div class="input-group-prepend">
                    <span class="input-group-text">Result</span>
                </div>
                <textarea class="form-control" id="output"></textarea>
            </div>
            <button type="button" id="okBtn" class="btn btn-secondary">ok</button>
        </div>
    </div>
    {% include 'navbar.html' %}
    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script>
        menu = location.pathname;
        if (menu == '/crypto/base-decode') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    $.post("/api/decode/base", {
                        enc: $("#input").val()
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/crypto/base-encode') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var baseVal = $('input[name="base"]:checked').val();
                    $.post("/api/encode/base", {
                        plain: $("#input").val(),
                        base: baseVal
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/hash/encrypt') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var hashVal = $('input[name="func"]:checked').val();
                    $.post("/api/encrypt/hash",  {
                        plain: $("#input").val(), 
                        func: hashVal
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/hash/decrypt') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var hashVal = $('input[name="func"]:checked').val();
                    $.post("/api/decrypt/hash", {
                        hash:$("#input").val(), func:hashVal
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/web/post') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var funcVal = $('input[name="func"]:checked').val();
                    $.post("/api/web/post", {
                        url: $("#url").val(),
                        json: $("#json-data").val(),
                        data: $("#form-data").val()
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/pwnable/terminal') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var command = $("#input").val();
                    $.post("/api/pwn/terminal", {
                        cmd: command
                    }, function(data) {
                        $("#output").val(data);
                    });
                });
            });
        }
        else if (menu == '/forensic/file-info') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var fDat = new FormData;
                    fDat.append("file", $("input[name=file]")[0].files[0]);
                    $.ajax({
                        url: '/api/forensic/fileinfo',
                        data: fDat,
                        processData: false,
                        contentType: false,
                        type: 'POST',
                        success: function(data) {
                            $("#output").val(data);
                        }
                    });
                });
            });
        }
        else if (menu == '/forensic/find-string') {
            $(document).ready(function() {
                $("#okBtn").click(function() {
                    var fDat = new FormData;
                    fDat.append("file", $("input[name=file]")[0].files[0]);
                    fDat.append("regex", $("#input").val());
                    $.ajax({
                        url: '/api/forensic/findstring',
                        data: fDat,
                        processData: false,
                        contentType: false,
                        type: 'POST',
                        success: function(data) {
                            $("#output").val(data);
                        }
                    });
                });
            });
        }
    </script>
</body>

</html>
